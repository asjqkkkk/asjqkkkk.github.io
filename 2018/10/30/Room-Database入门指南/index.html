<!DOCTYPE html>












  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2"/>
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />






















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=6.3.0" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.3.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.3.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.3.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '6.3.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="è¯´åˆ°Androidç«¯æœ‰å“ªäº›å¯ä»¥ä½¿ç”¨çš„æ•°æ®åº“ï¼Œå¤§å®¶é¦–å…ˆæƒ³åˆ°çš„è‡ªç„¶æ˜¯SQLiteè¿™ç§å¸¦æœ‰å®˜æ–¹å±æ€§åŠ æŒçš„è½»å‹çš„æ•°æ®åº“ã€‚ ä¸è¿‡å¯¹äºåƒæˆ‘è¿™ç§åŸºæœ¬ä¸Šæ²¡æœ‰æ¥è§¦è¿‡SQLæ•°æ®åº“è¯­è¨€ç¼–å†™çš„äººæ¥è¯´ï¼Œè¦é€šè¿‡å»å†™éš¾ä»¥æŸ¥é”™ä¸”åˆæ¯«ä¸ç†Ÿæ‚‰çš„æ•°æ®åº“ä»£ç æ‰èƒ½æ“ä½œæ•°æ®åº“çš„è¯ï¼Œé‚£å°±å¤ªä»¤äººå¤´å¤§äº†ã€‚  äºæ˜¯ä¹ï¼Œä¾¿äºAndroidå¼€å‘è€…æ“ä½œæ•°æ®åº“çš„æ¡†æ¶ä¹Ÿå°±å¤šäº†èµ·æ¥ï¼Œå…¶ä¸­äººæ°”è¾ƒé«˜çš„å°±æœ‰GreenDaoã€Realmï¼ŒObjectBoxç­‰ï¼Œè€ŒRoo">
<meta name="keywords" content="Android">
<meta property="og:type" content="article">
<meta property="og:title" content="Room Databaseå…¥é—¨æŒ‡å—">
<meta property="og:url" content="http://yoursite.com/2018/10/30/Room-Databaseå…¥é—¨æŒ‡å—/index.html">
<meta property="og:site_name" content="è€æ™¨å­ã®åšå®¢">
<meta property="og:description" content="è¯´åˆ°Androidç«¯æœ‰å“ªäº›å¯ä»¥ä½¿ç”¨çš„æ•°æ®åº“ï¼Œå¤§å®¶é¦–å…ˆæƒ³åˆ°çš„è‡ªç„¶æ˜¯SQLiteè¿™ç§å¸¦æœ‰å®˜æ–¹å±æ€§åŠ æŒçš„è½»å‹çš„æ•°æ®åº“ã€‚ ä¸è¿‡å¯¹äºåƒæˆ‘è¿™ç§åŸºæœ¬ä¸Šæ²¡æœ‰æ¥è§¦è¿‡SQLæ•°æ®åº“è¯­è¨€ç¼–å†™çš„äººæ¥è¯´ï¼Œè¦é€šè¿‡å»å†™éš¾ä»¥æŸ¥é”™ä¸”åˆæ¯«ä¸ç†Ÿæ‚‰çš„æ•°æ®åº“ä»£ç æ‰èƒ½æ“ä½œæ•°æ®åº“çš„è¯ï¼Œé‚£å°±å¤ªä»¤äººå¤´å¤§äº†ã€‚  äºæ˜¯ä¹ï¼Œä¾¿äºAndroidå¼€å‘è€…æ“ä½œæ•°æ®åº“çš„æ¡†æ¶ä¹Ÿå°±å¤šäº†èµ·æ¥ï¼Œå…¶ä¸­äººæ°”è¾ƒé«˜çš„å°±æœ‰GreenDaoã€Realmï¼ŒObjectBoxç­‰ï¼Œè€ŒRoo">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/001-001.jpg">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/001-002.jpg">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/001.jpeg">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/002.jpeg">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/003.jpeg">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/004.jpeg">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/005.jpeg">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/006.jpeg">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/007.png">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/009.png">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/008.png">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/010.png">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/011.png">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/012.png">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/013.png">
<meta property="og:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/014.png">
<meta property="og:updated_time" content="2018-10-30T11:13:28.519Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Room Databaseå…¥é—¨æŒ‡å—">
<meta name="twitter:description" content="è¯´åˆ°Androidç«¯æœ‰å“ªäº›å¯ä»¥ä½¿ç”¨çš„æ•°æ®åº“ï¼Œå¤§å®¶é¦–å…ˆæƒ³åˆ°çš„è‡ªç„¶æ˜¯SQLiteè¿™ç§å¸¦æœ‰å®˜æ–¹å±æ€§åŠ æŒçš„è½»å‹çš„æ•°æ®åº“ã€‚ ä¸è¿‡å¯¹äºåƒæˆ‘è¿™ç§åŸºæœ¬ä¸Šæ²¡æœ‰æ¥è§¦è¿‡SQLæ•°æ®åº“è¯­è¨€ç¼–å†™çš„äººæ¥è¯´ï¼Œè¦é€šè¿‡å»å†™éš¾ä»¥æŸ¥é”™ä¸”åˆæ¯«ä¸ç†Ÿæ‚‰çš„æ•°æ®åº“ä»£ç æ‰èƒ½æ“ä½œæ•°æ®åº“çš„è¯ï¼Œé‚£å°±å¤ªä»¤äººå¤´å¤§äº†ã€‚  äºæ˜¯ä¹ï¼Œä¾¿äºAndroidå¼€å‘è€…æ“ä½œæ•°æ®åº“çš„æ¡†æ¶ä¹Ÿå°±å¤šäº†èµ·æ¥ï¼Œå…¶ä¸­äººæ°”è¾ƒé«˜çš„å°±æœ‰GreenDaoã€Realmï¼ŒObjectBoxç­‰ï¼Œè€ŒRoo">
<meta name="twitter:image" content="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/001-001.jpg">



  <link rel="alternate" href="/atom.xml" title="è€æ™¨å­ã®åšå®¢" type="application/atom+xml" />




  <link rel="canonical" href="http://yoursite.com/2018/10/30/Room-Databaseå…¥é—¨æŒ‡å—/"/>



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Room Databaseå…¥é—¨æŒ‡å— | è€æ™¨å­ã®åšå®¢</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

	<a href="https://github.com/asjqkkkk" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#fff; color:#151513; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
    
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">è€æ™¨å­ã®åšå®¢</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">æƒ³å†™çš„æ—¶å€™å†™ä¸€äº›</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br />é¦–é¡µ</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />å½’æ¡£</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/10/30/Room-Databaseå…¥é—¨æŒ‡å—/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Old Chen">
      <meta itemprop="description" content="çŸ¥æƒ‘é¡¿æ–­å¦‚ç¢çŸ³ï¼Œæ€æƒ‘éš¾æ–­å¦‚è—•ä¸">
      <meta itemprop="image" content="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1532883475752&di=918e8ad03b17db01c84cdca20dd0ecdb&imgtype=0&src=http%3A%2F%2Fimg5.duitang.com%2Fuploads%2Fitem%2F201204%2F28%2F20120428125420_iUrGK.thumb.700_0.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="è€æ™¨å­ã®åšå®¢">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Room Databaseå…¥é—¨æŒ‡å—
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2018-10-30 19:12:38 / ä¿®æ”¹æ—¶é—´ï¼š19:13:28" itemprop="dateCreated datePublished" datetime="2018-10-30T19:12:38+08:00">2018-10-30</time>
            

            
              

              
            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>è¯´åˆ°Androidç«¯æœ‰å“ªäº›å¯ä»¥ä½¿ç”¨çš„æ•°æ®åº“ï¼Œå¤§å®¶é¦–å…ˆæƒ³åˆ°çš„è‡ªç„¶æ˜¯SQLiteè¿™ç§å¸¦æœ‰å®˜æ–¹å±æ€§åŠ æŒçš„è½»å‹çš„æ•°æ®åº“ã€‚</p>
<p>ä¸è¿‡å¯¹äºåƒæˆ‘è¿™ç§åŸºæœ¬ä¸Šæ²¡æœ‰æ¥è§¦è¿‡SQLæ•°æ®åº“è¯­è¨€ç¼–å†™çš„äººæ¥è¯´ï¼Œè¦é€šè¿‡å»å†™éš¾ä»¥æŸ¥é”™ä¸”åˆæ¯«ä¸ç†Ÿæ‚‰çš„æ•°æ®åº“ä»£ç æ‰èƒ½æ“ä½œæ•°æ®åº“çš„è¯ï¼Œé‚£å°±å¤ªä»¤äººå¤´å¤§äº†ã€‚</p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/001-001.jpg" alt="image"></p>
<p>äºæ˜¯ä¹ï¼Œä¾¿äºAndroidå¼€å‘è€…æ“ä½œæ•°æ®åº“çš„æ¡†æ¶ä¹Ÿå°±å¤šäº†èµ·æ¥ï¼Œå…¶ä¸­äººæ°”è¾ƒé«˜çš„å°±æœ‰GreenDaoã€Realmï¼ŒObjectBoxç­‰ï¼Œè€ŒRoomåˆ™æ˜¯è°·æ­Œå®˜æ–¹ååˆ†æ¨èçš„ï¼Œå¯ä»¥ä»£æ›¿SQliteçš„ä¸äºŒä¹‹é€‰ã€‚<br><a id="more"></a><br>æœ¬ç¯‡çš„ä¸»è¦ä»‹ç»å¯¹è±¡ä¹Ÿæ˜¯Roomæ•°æ®åº“ï¼Œä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œè¿˜å¾—ç®€å•ä»‹ç»ä¸€ä¸‹ä¸Šé¢æåˆ°è¿‡çš„å…¶ä»–å‡ ä½ï¼ŒåŒæ—¶åšä¸ªå°å°çš„å¯¹æ¯”ã€‚</p>
<h1 id="ä¸€ã€ä»‹ç»ä¸æ¯”è¾ƒ"><a href="#ä¸€ã€ä»‹ç»ä¸æ¯”è¾ƒ" class="headerlink" title="ä¸€ã€ä»‹ç»ä¸æ¯”è¾ƒ"></a>ä¸€ã€ä»‹ç»ä¸æ¯”è¾ƒ</h1><p>ç”±äºæˆ‘ç”¨è¿‡çš„æ•°æ®åº“æ¡†æ¶å¹¶ä¸å¤šï¼Œæ‰€ä»¥å¯¹äºç”¨è¿‡çš„å¯ä»¥è¯´ä¸€ä¸‹æ„Ÿå—ï¼Œæ²¡ç”¨è¿‡çš„å°±ç®€å•å¸¦è¿‡äº†ã€‚</p>
<h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h2><h3 id="GreenDao-å’Œ-ObjectBox"><a href="#GreenDao-å’Œ-ObjectBox" class="headerlink" title="GreenDao å’Œ ObjectBox"></a>GreenDao å’Œ ObjectBox</h3><p>åœ¨è¿™äº›æ•°æ®åº“ä¸­ï¼Œ <strong>GreenDao</strong> ç®—æ˜¯æ—©é—»å…¶åï¼Œä¸è¿‡ä¸€ç›´æ²¡æœ‰ç”¨è¿‡ï¼Œåæ¥å®ƒçš„ä½œè€…åˆå‡ºäº†ä¸ª <strong>ObjectBox</strong> ï¼Œè€Œä¸”ä½ å¯ä»¥åœ¨ <a href="https://github.com/greenrobot/greenDAO" target="_blank" rel="noopener"><strong>GreenDao</strong>çš„GitHubé¡µé¢</a> æ‰¾åˆ°æ¨èä½¿ç”¨ <strong>ObjectBox</strong> çš„ <a href="https://objectbox.io/" target="_blank" rel="noopener">ObjectBoxåœ°å€</a> .</p>
<h3 id="Realm"><a href="#Realm" class="headerlink" title="Realm"></a>Realm</h3><p>æˆ‘çœŸæ­£ä½¿ç”¨è¿‡çš„è¿˜åªæœ‰ <strong>Realm</strong> æ•°æ®åº“ï¼Œè¿™é‡Œè¦æä¸€ä¸‹ï¼Œ<strong>Realm</strong> æ•°æ®åº“å¯¹äºä¸­å›½çš„å¼€å‘è€…éå¸¸çš„å‹å¥½ï¼Œå°±åƒå¤§åé¼é¼çš„Glideä¸€æ ·ï¼Œ <strong>Realm</strong> ä¹Ÿæœ‰ä¸­æ–‡çš„ä»‹ç»æ–‡æ¡£ï¼Œæ–‡æ¡£åœ°å€åœ¨æ­¤ï¼š<br><a href="https://realm.io/cn/docs/java/latest/" target="_blank" rel="noopener">å¼€å§‹ä½¿ç”¨Realm</a><br>è™½ç„¶è¿™ä»½æ–‡æ¡£å¯¹åº”çš„ç‰ˆæœ¬ä¸æ˜¯æœ€æ–°çš„. ä¸è¿‡å¯¹äºåˆæ¬¡æ¥è§¦ <strong>Realm</strong> äººæ¥è¯´ï¼Œçœ‹è¿™ä»½æ–‡æ¡£å°±å¯ä»¥ä¸Šæ‰‹äº†</p>
<p>æœ€å¼€å§‹ä½¿ç”¨Realmçš„æ—¶å€™ä¹Ÿæ˜¯ç¢°è¿‡ä¸å°‘å‘ï¼Œä¸è¿‡æœ€ä¸»è¦çš„æ˜¯æ‰€æœ‰æ•°æ®åº“å¯¹è±¡éœ€è¦ç»§æ‰¿ <strong>RealmObject</strong> è¿™ä¸ªç±»(ä¹Ÿå¯ä»¥é€šè¿‡æ¥å£å®ç°)ï¼Œè¿™æ ·å¯¹é¡¹ç›®å·²æœ‰çš„æ•°æ®ç»“æ„ä¸å¤ªå‹å¥½ï¼ŒåŒæ—¶æˆ‘è¿˜å‘ç°ç»§æ‰¿äº† <strong>RealmObject</strong> çš„å¯¹è±¡å¹¶ä¸èƒ½ä¸ <strong>Gson</strong> å®Œç¾ç»“åˆï¼Œå¦‚æœéœ€è¦è½¬æ¢çš„è¯ï¼Œè¿˜æ˜¯å¾—è´¹ä¸€ç•ªå‘¨æŠ˜çš„ã€‚<br>ç§ç§åŸå› ï¼Œå¯¼è‡´æˆ‘æœ€åä»é¡¹ç›®ä¸­æŠ½å»äº†Realmè¿™ä¸ªæ•°æ®åº“.</p>
<h3 id="Room"><a href="#Room" class="headerlink" title="Room"></a>Room</h3><p>ä¸ Realm åˆ†æ‰‹åçš„æ—¥å­é‡Œï¼Œæˆ‘å¹¶æ²¡æœ‰æ”¾å¼ƒå¯¹æ–°çš„æ•°æ®åº“çš„å¯»æ‰¾ï¼Œåæ¥åœ¨æµè§ˆ Googleå®˜æ–¹æ–‡æ¡£çš„æ—¶å€™æ‰å‘ç°äº† <strong>Room</strong> è¿™ä¸ªæ–°çš„æ•°æ®åº“ï¼Œç»è¿‡æˆ‘ä¸€ç•ªä½¿ç”¨åï¼Œå°±å†³å®šæ˜¯å®ƒäº†ï¼<br><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/001-002.jpg" alt="image"></p>
<h2 id="æ¯”è¾ƒ"><a href="#æ¯”è¾ƒ" class="headerlink" title="æ¯”è¾ƒ"></a>æ¯”è¾ƒ</h2><p>å› ä¸ºæ‡’æƒ°çš„åŸå› ï¼Œæˆ‘å¹¶æ²¡æœ‰åšè¿‡æ·±å…¥çš„æµ‹è¯•ï¼Œä¸‹é¢ä¼šç»™å‡ºä»ç½‘ä¸Šæ‰¾åˆ°çš„å…³äºè¿™äº›æ•°æ®åº“çš„å¯¹æ¯”ï¼ŒåŸæ–‡åœ°å€å¦‚ä¸‹ï¼š</p>
<p><a href="https://notes.devlabs.bg/realm-objectbox-or-room-which-one-is-for-you-3a552234fd6e" target="_blank" rel="noopener"><strong>Realm, ObjectBox or Room. Which one is for you?</strong></a></p>
<p>ç„¶åæ˜¯æ•°æ®é‡è¾¾åˆ° <strong>100k/10k</strong> çš„æ—¶å€™ï¼Œè¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰æ“ä½œæ¶ˆè€—çš„æ—¶é—´å¯¹æ¯”ï¼š</p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/001.jpeg" alt="image"><br><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/002.jpeg" alt="image"></p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/003.jpeg" alt="image"><br><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/004.jpeg" alt="image"></p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/005.jpeg" alt="image"><br><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/006.jpeg" alt="image"></p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨å„ä¸ªæ–¹é¢ï¼Œç»Ÿç»Ÿéƒ½æ˜¯ <strong>ObjectBox</strong> å‚²è§†ç¾¤é›„ã€‚<br>é‚£è¿™ç¯‡æ–‡ç« ä¸ºä»€ä¹ˆè¿˜æ˜¯è¦å†™ä»‹ç»å…³äº <strong>Room Database</strong> å‘¢ï¼Ÿ</p>
<p>é¦–å…ˆæ˜¯å®˜æ–¹BuffåŠ æŒï¼Œå’Œä»‹ç»æ–‡æ¡£é‡Œçš„ä¸€å¥è¯ï¼š<br><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/007.png" alt="image"><br><a href="https://developer.android.google.cn/training/data-storage/room/" target="_blank" rel="noopener">è¿™é‡Œæ˜¯Roomçš„å®˜æ–¹ä»‹ç»æ–‡æ¡£åœ°å€</a></p>
<p>å¤§è‡´æ„æ€å°±æ˜¯ï¼š<strong>æˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ç”¨Roonå»ä»£æ›¿SQLiteï¼Œä¸è¿‡å¦‚æœä½ æ˜¯ä¸ªé“å¤´å¨ƒéå¾—ç”¨SQLiteï¼Œé‚£æˆ‘ä»¬ä¹Ÿæ²¡æœ‰åŠæ³•ã€‚</strong></p>
<p>é™¤äº†ä¸Šé¢è¿™æ®µè¯ï¼Œè¿˜æœ‰ä¸€ç‚¹ä¹Ÿå¯ä»¥ä½œä¸ºé€‰æ‹©Roomçš„åŸå› ï¼Œå°±æ˜¯å¯¹äºApkçš„â€œå¢é‡â€æ˜¯å¤šå°‘ã€‚æ®åˆ«äººçš„æµ‹è¯•</p>
<blockquote>
<p>ObjectBoxå’ŒRealmåˆ†åˆ«å ç”¨1-1.5MBå’Œ3-4MBï¼ˆå¤§å°å–å†³äºæ‰‹æœºæ¶æ„ï¼‰ï¼Œè€Œä½œä¸ºSQLå°è£…çš„Roomåªå ç”¨å¤§çº¦50KBã€‚åœ¨æ–¹æ³•çš„å¢é‡ä¸Šï¼ŒRoomåªæœ‰300å¤šä¸ªï¼ŒObjectBoxå’ŒRealmåˆ™åˆ†åˆ«æ˜¯1300å’Œ2000ä¸ª</p>
</blockquote>
<p>å½“ç„¶ï¼Œå¦‚æœä½ çš„æ•°æ®é‡å¾ˆå¤§çš„è¯ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯ <strong>ObjectBox</strong> æ›´åŠ é€‚åˆä½ ï¼Œå› ä¸ºå°±ä»ä¸Šé¢çš„æ“ä½œæ•°æ®å¯¹æ¯”æ¥çœ‹ï¼Œ <strong>ObjectBox</strong> å¤ªç‰›é€¼äº†ï¼æˆ‘ä»¥åè‚¯å®šä¹Ÿä¼šèŠ±æ—¶é—´å»å¯¹ <strong>ObjectBox</strong> åšä¸€ç•ªç ”ç©¶ï¼Œä¸è¿‡ç›®å‰è¿˜æ˜¯å…ˆæ¥ä»‹ç»ä»‹ç» <strong>Room</strong> å§ã€‚</p>
<h1 id="äºŒã€Roomçš„ç»“æ„"><a href="#äºŒã€Roomçš„ç»“æ„" class="headerlink" title="äºŒã€Roomçš„ç»“æ„"></a>äºŒã€Roomçš„ç»“æ„</h1><p>ä¹‹å‰æœ‰è¯´è¿‡ï¼Œ<strong>Room</strong> æ˜¯å¯ä»¥ä»£æ›¿ <strong>SQLite</strong> çš„ï¼Œä¸è¿‡æˆ‘è§‰å¾—Googleæ¨å‡ºå®ƒæ›´å¤šçš„æ˜¯ä¸ºäº†æ­é… <strong>DataBinding</strong> ä½¿ç”¨ï¼Œå¦‚æœä½ å¯¹äº <strong>DataBinding</strong> ä¸å¤ªç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹ä¸€çœ‹æˆ‘å‰é¢çš„å…³äº <strong>DataBinding</strong> çš„æ–‡ç« ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚ä¸‹é¢å°±å¼€å§‹è¯´è¯´ <strong>Room</strong> çš„ç»“æ„ã€‚</p>
<p>Roomä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ <strong>Database</strong>(æ•°æ®åº“) ã€<strong>Entity</strong>(å®ä½“) ã€<strong>DAO</strong>(æ•°æ®è®¿é—®å¯¹è±¡) </p>
<h2 id="Database-æ•°æ®åº“"><a href="#Database-æ•°æ®åº“" class="headerlink" title="Database(æ•°æ®åº“)"></a>Database(æ•°æ®åº“)</h2><p>æ•°æ®åº“æŒ‡çš„å°±æ˜¯ä¸€ä¸ªæ•°æ®åº“å¯¹è±¡ï¼Œå®ƒç»§æ‰¿äº <strong>RoomDataBase</strong> è¿™ä¸ªç±»ï¼Œå¹¶ä¸”éœ€è¦ç”¨ <strong>@DataBase</strong> æ³¨è§£ï¼Œè·å–è¿™ä¸ªæ•°æ®åº“å¯¹è±¡çš„æ–¹æ³•æ˜¯é€šè¿‡è°ƒç”¨ <strong>Room.databaseBuilder()</strong> æˆ–è€… <strong>Room.inMemoryDatabaseBuilder()</strong> ï¼Œåè€…è¡¨ç¤ºåœ¨å†…å­˜ä¸­å­˜å‚¨æ•°æ®ï¼Œå¦‚æœç¨‹åºç»“æŸäº†æ•°æ®ä¹Ÿå°±æ¶ˆå¤±äº†ï¼Œæ‰€ä»¥ä¸€èˆ¬è¿˜æ˜¯ä½¿ç”¨å‰è€…ã€‚</p>
<h2 id="Entity-å®ä½“"><a href="#Entity-å®ä½“" class="headerlink" title="Entity(å®ä½“)"></a>Entity(å®ä½“)</h2><p>å®ä½“çš„æ¦‚å¿µå°±æ¯”è¾ƒç®€å•äº†ï¼Œå°±ç±»ä¼¼äºMySQLæ•°æ®åº“é‡Œé¢çš„è¡¨ï¼Œä¸€ä¸ªå®ä½“ç±»ç›¸å½“äºä¸€ä¸ªè¡¨ï¼Œè€Œä¸€ä¸ªå®ä½“ç±»æœ‰å¤šä¸ªå±æ€§ï¼Œå°±ç›¸å½“äºè¡¨çš„å¤šä¸ªå­—æ®µï¼Œè¿™ä¸ªçœ‹ä¸€çœ‹æ¥ä¸‹æ¥å…³äº <strong>Entity</strong> çš„ä»£ç ä¾¿ä¸€ç›®äº†ç„¶ã€‚</p>
<h2 id="DAO"><a href="#DAO" class="headerlink" title="DAO"></a>DAO</h2><p>å…³äº <strong>DAO</strong> ï¼ŒæŠ½è±¡çš„æ¦‚å¿µå°±è¡¨ç¤º<strong>æ•°æ®è®¿é—®å¯¹è±¡</strong>ï¼Œåœ¨è¿™é‡Œç®€å•çš„è§£é‡Šä¸€ä¸‹å°±æ˜¯æ•°æ®æ“ä½œæ¥å£ï¼Œå¯ä»¥é€šè¿‡ç¼–å†™ <strong>DAOæ¥å£</strong> å¯¹æ•°æ®åº“è¿›è¡Œå¢åˆ æ”¹æŸ¥ç­‰ä¸€ç³»åˆ—æ“ä½œã€‚  </p>
<blockquote>
<p>PS:è¿™äº›æ¥å£å¯ä»¥æ”¯æŒRxJavaçš„å“¦ï¼</p>
</blockquote>
<p>ä¸‹é¢æ˜¯å›¾ç‰‡è¯´æ˜ï¼š</p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/009.png" alt="image"></p>
<h1 id="ä¸‰ã€å¼€å§‹ä½¿ç”¨"><a href="#ä¸‰ã€å¼€å§‹ä½¿ç”¨" class="headerlink" title="ä¸‰ã€å¼€å§‹ä½¿ç”¨"></a>ä¸‰ã€å¼€å§‹ä½¿ç”¨</h1><p>åœ¨ <strong>Room</strong> çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œä¹Ÿæ˜¯é‡åˆ°ä¸€äº›å‘çš„ï¼Œä¸è¿‡éƒ½å·²ç»è§£å†³æ‰äº†ã€‚å¦‚æœä½ ä¹Ÿé‡åˆ°è¿‡æŸäº›é—®é¢˜ï¼Œä¸å¦¨å¯¹ç…§ä¸€ä¸‹æˆ‘çš„æ¥å…¥æµç¨‹ï¼Œè¯´ä¸å®šå°±æ‰¾åˆ°äº†é—®é¢˜æ‰€åœ¨ã€‚</p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/008.png" alt="image"></p>
<h2 id="æ¥å…¥Gradle"><a href="#æ¥å…¥Gradle" class="headerlink" title="æ¥å…¥Gradle"></a>æ¥å…¥Gradle</h2><p>ä¸ºäº†é¿å…ä¹‹åçš„å•å…ƒæµ‹è¯•å‡ºç° <font color="#DC143C">java.lang.RuntimeException: Method e in android.util.Log not mocked. See <a href="http://g.co/androidstudio/not-mocked" target="_blank" rel="noopener">http://g.co/androidstudio/not-mocked</a> for details.</font> çš„é”™è¯¯ï¼Œé™¤äº† <strong>Room</strong> ç›¸å…³çš„ä¾èµ–éœ€è¦æ·»åŠ å¤–ï¼Œè¿™é‡Œè¿˜éœ€è¦å†å¼•ç”¨ä¸€ä¸‹ <strong>robolectricå•å…ƒæµ‹è¯•åº“</strong> è§£å†³é—®é¢˜ï¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">    //roomæ•°æ®åº“</span><br><span class="line">    def room_version = &quot;1.1.1&quot;</span><br><span class="line">    implementation &quot;android.arch.persistence.room:runtime:$room_version&quot;</span><br><span class="line">    annotationProcessor &quot;android.arch.persistence.room:compiler:$room_version&quot;</span><br><span class="line">    kapt &quot;android.arch.persistence.room:compiler:$room_version&quot;      // ç”±äºè¦ä½¿ç”¨Kotlin,è¿™é‡Œä½¿ç”¨äº†kapt</span><br><span class="line">    implementation &quot;android.arch.persistence.room:rxjava2:$room_version&quot;        //ä¹‹åä¼šç”¨åˆ°rxjavaï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå¯ä»¥æœ‰</span><br><span class="line">//    implementation &quot;android.arch.persistence.room:guava:$room_version&quot;        //ç”±äºæˆ‘ä»¬ä¸ç”¨guavaï¼Œè¿™è¡Œæ³¨é‡Šæ‰</span><br><span class="line">    testImplementation &quot;android.arch.persistence.room:testing:$room_version&quot; </span><br><span class="line">    </span><br><span class="line">    //robolectricæµ‹è¯•</span><br><span class="line">    testImplementation &apos;org.robolectric:shadows-multidex:3.8&apos;</span><br><span class="line">    testImplementation &quot;org.robolectric:robolectric:3.8&quot;</span><br><span class="line">    //è¿™æ ·å°±èµ„ç“·å•å…ƒæµ‹è¯•å’¯ï¼</span><br></pre></td></tr></table></figure>
<p>å’Œæˆ‘ä¸€æ ·ä½¿ç”¨Kotlinçš„ç«¥é‹åˆ«å¿˜äº†ä¸‹é¢è¿™è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: &apos;kotlin-kapt&apos;</span><br></pre></td></tr></table></figure>
<p>è¿˜æœ‰ï¼Œéœ€è¦åšå¦‚ä¸‹æ›´æ”¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">androidTestImplementation &apos;com.android.support.test:runner:1.0.2&apos;</span><br><span class="line"></span><br><span class="line">//æ›´æ”¹ä¸º</span><br><span class="line">implementation &apos;com.android.support.test:runner:1.0.2&apos;</span><br></pre></td></tr></table></figure>
<p>è¿™ç‚¹ä¸€å®šè¦æ”¹å“¦ï¼ä¸ç„¶ä¼šå‡ºç°ä¸€äº›è«åå…¶å¦™çš„é—®é¢˜</p>
<p>ç›¸å…³åº“çš„ä¾èµ–æˆåŠŸæ·»åŠ åå°±å¯ä»¥å¼€å§‹åŠ¨æ‰‹äº†ï¼</p>
<h2 id="åˆ›å»º-Entityã€Dao-ä¸-DataBase"><a href="#åˆ›å»º-Entityã€Dao-ä¸-DataBase" class="headerlink" title="åˆ›å»º Entityã€Dao ä¸ DataBase"></a>åˆ›å»º Entityã€Dao ä¸ DataBase</h2><h3 id="åˆ›å»ºEntity"><a href="#åˆ›å»ºEntity" class="headerlink" title="åˆ›å»ºEntity"></a>åˆ›å»ºEntity</h3><p>é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª <strong>Entity</strong> å¯¹è±¡ï¼Œå°±æŠŠå®ƒå‘½åä¸º <strong>Book</strong> å§</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">@Entity</span><br><span class="line">class Book(@field:ColumnInfo(name = &quot;book_name&quot;)</span><br><span class="line">           var bookName: String?, var author: String?, var type: String?) &#123;</span><br><span class="line"></span><br><span class="line">    @PrimaryKey(autoGenerate = true)</span><br><span class="line">    var id: Int = 0</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Book</strong> æœ‰ä¸‰ä¸ªå±æ€§ï¼Œåˆ†åˆ«è¡¨ç¤ºä¹¦åã€ä½œè€…ã€ç±»å‹ã€‚å…¶ä¸­æœ‰ä¸‰ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>æ¯ä¸ª <strong>Entityå¯¹è±¡</strong> éƒ½éœ€è¦ä½¿ç”¨ <strong>@Entity</strong> æ³¨é‡Šå£°æ˜</li>
<li><strong>@PrimaryKey</strong> æ³¨é‡Šç”¨äºå£°æ˜ä¸»é”®ï¼Œè¿™é‡Œè¿˜æ·»åŠ äº† autoGenerate = trueï¼Œè¡¨ç¤ºå®ƒæ˜¯è‡ªå¢çš„</li>
<li><strong>@ColumnInfo</strong> æ³¨é‡Šç”¨æ¥ç»™å±æ€§è®¾ç½®åˆ«åï¼Œå¦‚æœ <strong>bookName</strong> å±æ€§ä¸è®¾ç½®åˆ«åçš„è¯ï¼ŒæŸ¥è¯¢çš„æ—¶å€™å¯ä»¥é€šè¿‡ â€œ<strong>bookName</strong>â€è¿›è¡ŒæŸ¥è¯¢ï¼Œè®¾ç½®åˆ«ååå°±å¯ä»¥é€šè¿‡è®¾ç½®çš„â€œ<strong>book_name</strong>â€ è¿›è¡ŒæŸ¥è¯¢äº†ï¼Œçœ‹ <strong>DAOæ¥å£</strong> ä¾¿çŸ¥</li>
</ul>
<h3 id="åˆ›å»º-DAO"><a href="#åˆ›å»º-DAO" class="headerlink" title="åˆ›å»º DAO"></a>åˆ›å»º DAO</h3><p>è¿™é‡Œï¼Œé€šè¿‡ <strong>DAOæ¥å£</strong> æ¥å¯¹ <strong>Book</strong> è¿™ä¸ªå¯¹è±¡è¿›è¡Œå¢åˆ æ”¹æŸ¥ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">@Dao</span><br><span class="line">interface BookDao &#123;</span><br><span class="line"></span><br><span class="line">    @get:Query(&quot;SELECT * FROM book&quot;)</span><br><span class="line">    val all: List&lt;Book&gt;</span><br><span class="line"></span><br><span class="line">    @Query(&quot;SELECT * FROM book WHERE author LIKE :author&quot;)</span><br><span class="line">    fun getBookByAuthor(author: String): List&lt;Book&gt;</span><br><span class="line"></span><br><span class="line">    @Query(&quot;SELECT * FROM book WHERE book_name LIKE :name&quot;)</span><br><span class="line">    fun getBookByNamer(name: String): List&lt;Book&gt;</span><br><span class="line"></span><br><span class="line">    @Insert</span><br><span class="line">    fun insert(book: Book): Long?</span><br><span class="line"></span><br><span class="line">    @Insert</span><br><span class="line">    fun insert(vararg books: Book): List&lt;Long&gt;</span><br><span class="line"></span><br><span class="line">    @Insert</span><br><span class="line">    fun insert(books: List&lt;Book&gt;): List&lt;Long&gt;</span><br><span class="line"></span><br><span class="line">    @Update</span><br><span class="line">    fun update(book: Book): Int</span><br><span class="line"></span><br><span class="line">    @Update</span><br><span class="line">    fun update(vararg books: Book): Int</span><br><span class="line"></span><br><span class="line">    @Update</span><br><span class="line">    fun update(books: List&lt;Book&gt;): Int</span><br><span class="line"></span><br><span class="line">    @Delete</span><br><span class="line">    fun delete(book: Book): Int</span><br><span class="line"></span><br><span class="line">    @Delete</span><br><span class="line">    fun delete(vararg books: Book): Int</span><br><span class="line"></span><br><span class="line">    @Delete</span><br><span class="line">    fun delete(books: List&lt;Book&gt;): Int</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„ <strong>DAOæ¥å£</strong>ï¼ŒåŒæ ·éœ€è¦è¿›è¡Œå‡ ç‚¹è¯´æ˜ï¼š</p>
<ul>
<li><strong>DAOæ¥å£</strong> éœ€è¦ä½¿ç”¨ <strong>@Dao</strong> æ³¨é‡Šè¿›è¡Œå£°æ˜</li>
<li><strong>Insert</strong> æ“ä½œå¯ä»¥ä½¿ç”¨ <strong>Long</strong> ä½œä¸ºè¿”å›å€¼çš„ç±»å‹ï¼Œè¡¨ç¤ºæ’å…¥æ“ä½œå‰çš„å¯¹è±¡æ•°é‡</li>
<li><strong>Update</strong> å’Œ <strong>Delete</strong> æ“ä½œå¯ä»¥ä½¿ç”¨ Int ä½œä¸ºè¿”å›å€¼ï¼Œè¡¨ç¤ºæ›´æ–°æˆ–è€…åˆ é™¤çš„è¡Œæ•°</li>
<li>è¿”å›ç±»å‹è¿˜å¯ä»¥æ˜¯ <strong>void</strong> ï¼Œå¦‚æœç»“åˆ <strong>Rxjava</strong> ä½¿ç”¨çš„è¯è¿˜å¯ä»¥æ˜¯ <strong>Completableã€Singleã€ Maybeã€Flowable</strong>ç­‰ï¼Œå…·ä½“å¯ä»¥å‚è§è¿™ç¯‡æ–‡ç« ï¼š<a href="https://medium.com/androiddevelopers/room-rxjava-acb0cd4f3757" target="_blank" rel="noopener">Room ğŸ”— RxJava</a>(éœ€è¦å¤‡å¥½æ¢¯å­ï¼Œä¸è¿‡åç»­æœ‰æ—¶é—´çš„è¯æˆ‘ä¹Ÿä¼šä»‹ç»ä¸€ä¸‹Roomæ­é…Rxjavaçš„ä½¿ç”¨)</li>
</ul>
<p><strong>Daoæ¥å£</strong> ç¼–å†™å®Œæˆåï¼Œè¿˜å‰©ä¸‹æœ€é‡è¦çš„ <strong>DataBase</strong></p>
<h3 id="åˆ›å»º-DataBase"><a href="#åˆ›å»º-DataBase" class="headerlink" title="åˆ›å»º DataBase"></a>åˆ›å»º DataBase</h3><blockquote>
<p>ç”±äºå®ä¾‹åŒ–ä¸€ä¸ª <strong>RoomDatabase</strong> å¯¹è±¡çš„å¼€é”€æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥ <strong>DataBase</strong> çš„ä½¿ç”¨éœ€è¦éµå¾ªå•ä¾‹æ¨¡å¼ï¼Œåªåœ¨å…¨å±€åˆ›å»ºä¸€ä¸ªå®ä¾‹å³å¯ã€‚</p>
</blockquote>
<p>è¿™é‡Œä¸ºäº†æ–¹ä¾¿ç†è§£ï¼Œè¿˜æ˜¯ä½¿ç”¨javaä»£ç å»åˆ›å»ºä¸€ä¸ª <strong>BookDataBaseç±»</strong>ï¼Œå½“ç„¶ï¼Œè½¬æ¢æˆKotlinåªéœ€è¦Shift + Alt + Ctrl + K å³å¯</p>
<p>å¦‚æœä½ ä½¿ç”¨çš„æ˜¯é¥¿æ±‰å¼çš„å•ä¾‹æ¨¡å¼ï¼Œåœ¨Kotlinä¸­é€šè¿‡objectä¿®é¥°å¯è¾¾åˆ°åŒæ ·æ•ˆæœ<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">@Database(entities = &#123;Book.class&#125;, version = 1)</span><br><span class="line">public abstract class BookDataBase extends RoomDatabase &#123;</span><br><span class="line">    public abstract BookDao bookDao();</span><br><span class="line">    private static BookDataBase instance;</span><br><span class="line"></span><br><span class="line">    public static BookDataBase getInstance(Context context)&#123;</span><br><span class="line">        if (instance == null)&#123;</span><br><span class="line">            synchronized (BookDataBase.class)&#123;</span><br><span class="line">                if (instance == null)&#123;</span><br><span class="line">                    instance = create(context);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private static BookDataBase create(Context context) &#123;</span><br><span class="line">        return Room.databaseBuilder( context,BookDataBase.class,&quot;book-db&quot;).allowMainThreadQueries().build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>ä¸Šé¢çš„ä¾‹å­ä¸­æœ‰ä¸€äº›éœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
<ul>
<li><strong>@Database</strong> æ³¨é‡Šç”¨äºè¿›è¡Œå£°æ˜ï¼ŒåŒæ—¶è¿˜éœ€è¦æœ‰ç›¸å…³çš„ <strong>entityå¯¹è±¡</strong>ï¼Œå…¶ä¸­ <strong>version</strong> æ˜¯å½“å‰æ•°æ®åº“çš„ç‰ˆæœ¬å·ï¼Œå¦‚æœä½ å¯¹æ•°æ®ç›¸å…³çš„<strong>å®ä½“ç±»ç»“æ„</strong>è¿›è¡Œäº†æ›´æ”¹ï¼Œè¿™é‡Œçš„ <strong>version</strong> å°±éœ€è¦<strong>åŠ ä¸€</strong></li>
<li><strong>BookDataBase</strong> é™¤äº†ç»§æ‰¿äº <strong>RoomDatabase</strong> ï¼Œè¿˜éœ€è¦å®ä¾‹å‡ºç›¸å…³çš„ <strong>DAOæ¥å£</strong></li>
<li>create()æ–¹æ³•ä¸­çš„â€<strong>book-db</strong>â€œæ˜¯æ•°æ®åº“çš„åå­—ï¼Œè¿™é‡Œéšæ„ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ <strong>allowMainThreadQueries()</strong> æ–¹æ³•ï¼Œè¿™é‡Œç”±äºæˆ‘ä»¬ä¼šç”¨åˆ°å•å…ƒæµ‹è¯•ï¼Œæ‰€ä»¥åŠ ä¸Šè¿™è¡Œä»£ç æ˜¯ä¸ºäº†é˜²æ­¢ ã€<em>Cannot access database on the main thread since it may potentially lock the UI for a long period of time.</em>ã€‘ çš„æŠ¥é”™ã€‚æ­£å¼ä½¿ç”¨æ—¶ï¼Œè¯·åŠ¡å¿…å»æ‰è¿™è¡Œä»£ç ï¼Œå› ä¸ºå®ƒä¼šè®©æ‰€æœ‰è€—æ—¶æ“ä½œè¿è¡Œåœ¨ä¸»çº¿ç¨‹ï¼</li>
</ul>
<p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å°±å¯ä»¥å…ˆæ„‰å¿«çš„è¿›è¡Œæµ‹è¯•äº†.</p>
<h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h2><h3 id="åˆçº§æµ‹è¯•"><a href="#åˆçº§æµ‹è¯•" class="headerlink" title="åˆçº§æµ‹è¯•"></a>åˆçº§æµ‹è¯•</h3><p>æ‰¾åˆ° <strong>src</strong> ä¸‹çš„ <strong>test</strong> ç›®å½•ï¼Œç„¶åå¯ä»¥åƒæˆ‘è¿™æ ·åˆ›å»ºä¸€ä¸ª <strong>RoomTest</strong> ç±»è¿›è¡Œæµ‹è¯•</p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/010.png" alt="image"></p>
<p>è¯´åˆ°è¿™é‡Œï¼Œå¯èƒ½ä¼šæœ‰ç«¥é‹å°šæœªäº†è§£è¿‡å•å…ƒæµ‹è¯•ï¼Œè¿™æ—¶å€™ä½ å¯ä»¥å…ˆå»çœ‹çœ‹ç›¸å…³åšå®¢ï¼Œæ¯”å¦‚è¿™ç¯‡</p>
<p><a href="https://juejin.im/post/5b57e3fbf265da0f47352618" target="_blank" rel="noopener">Android å•å…ƒæµ‹è¯•åªçœ‹è¿™ä¸€ç¯‡å°±å¤Ÿäº†</a></p>
<p>ä¸è¿‡è¿™é‡Œä½¿ç”¨çš„å•å…ƒæµ‹è¯•æ˜¯ Android Studio è‡ªå¸¦çš„ï¼Œä¹Ÿæ²¡æœ‰ç”¨åˆ°å¤ªå¤æ‚çš„ä¸œè¥¿ï¼ŒåŒæ—¶æˆ‘ä¼šåšä¸€äº›è¯´æ˜ï¼Œä¸å¤Ÿäº†è§£çš„ç«¥é‹ä¹Ÿå¯ä»¥ç»§ç»­å¾€ä¸‹çœ‹ï¼Œçœ‹å®Œä½ ä¹Ÿå°±äº†è§£äº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">@RunWith(AndroidJUnit4::class)</span><br><span class="line">class RoomTest &#123;</span><br><span class="line"></span><br><span class="line">    private var bookDao: BookDao? = null</span><br><span class="line">    private var bookDataBase: BookDataBase? = null</span><br><span class="line"></span><br><span class="line">    @Before</span><br><span class="line">    @Throws(Exception::class)</span><br><span class="line">    fun setUp() &#123;</span><br><span class="line">        ShadowLog.stream = System.out      //è¿™æ ·æ–¹ä¾¿æ‰“å°æ—¥å¿—</span><br><span class="line">        val context = InstrumentationRegistry.getTargetContext()</span><br><span class="line">        bookDataBase = BookDataBase.getInstance(context)</span><br><span class="line">        bookDao = bookDataBase!!.bookDao()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    fun insert() &#123;</span><br><span class="line">        val book1 = Book(&quot;æ—¶é—´ç®€å²&quot;, &quot;æ–¯è’‚èŠ¬Â·å¨å»‰Â·éœé‡‘&quot;, &quot;ç§‘å­¦&quot;)</span><br><span class="line">        val book2 = Book(&quot;ç™¾å¹´å­¤ç‹¬&quot;, &quot;è¥¿äºšÂ·é©¬å°”å…‹æ–¯&quot;, &quot;æ–‡å­¦&quot;)</span><br><span class="line">        val list = bookDao!!.insert(book1, book2)</span><br><span class="line"></span><br><span class="line">        assert(list.size == 2)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Test</span><br><span class="line">    fun query()&#123;</span><br><span class="line">        val books = bookDao!!.all</span><br><span class="line">        for (book in books) &#123;</span><br><span class="line">            Log.e(javaClass.name, &quot;è·å–çš„ä¹¦ç±æ•°æ®: $&#123;Gson().toJson(book)&#125;&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @After</span><br><span class="line">    @Throws(Exception::class)</span><br><span class="line">    fun cloaseDb() &#123;</span><br><span class="line">        bookDataBase?.close()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¿™é‡Œçš„å•å…ƒæµ‹è¯•ä½¿ç”¨çš„æ˜¯ <strong>AndroidJUnit4</strong>ï¼Œé€šè¿‡ <strong>@Before</strong> æ³¨é‡Šçš„æ–¹æ³•ï¼Œè¡¨ç¤ºç”¨äº<strong>ç›¸å…³èµ„æºçš„åˆå§‹åŒ–</strong>ï¼Œç±»ä¼¼äºActivityçš„onCreate()æ–¹æ³•ï¼›è€Œé€šè¿‡ <strong>@After</strong> æ³¨é‡Šçš„æ–¹æ³•ï¼Œåˆ™æ˜¯ç”¨äº<strong>ç›¸å…³èµ„æºçš„é”€æ¯</strong>ï¼Œç±»ä¼¼äºActivityçš„onDestroy()æ–¹æ³•ã€‚</p>
<p>å‰©ä¸‹çš„ï¼Œé€šè¿‡ <strong>@Test</strong> æ³¨é‡Šçš„æ–¹æ³•å°±è¡¨ç¤ºç”¨äºæµ‹è¯•çš„å•å…ƒï¼Œæ¯ä¸ªæµ‹è¯•ç±»é‡Œé¢å¯ä»¥æœ‰å¤šä¸ªæµ‹è¯•å•å…ƒï¼Œè¿™é‡Œç›®å‰åªå†™äº†æ’å…¥å’ŒæŸ¥è¯¢ä¸¤ä¸ªå•å…ƒï¼Œåœ¨ <strong>RoomTest</strong> ç±»ä¸Šé€šè¿‡å³é”®è¿è¡Œï¼Œç„¶åçœ‹ä¸€ä¸‹ç»“æœï¼š<br><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/011.png" alt="image"></p>
<p>åœ¨æµ‹è¯•ä»£ç ä¸­çš„ <strong>insert()å•å…ƒ </strong> é‡Œï¼Œæœ‰è¿™æ ·ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(list.size == 2)</span><br></pre></td></tr></table></figure>
<p>è€Œæµ‹è¯•çš„ç»“æœæ˜¯ä¸€ç‰‡ç»¿è‰²ï¼Œå°±è¡¨ç¤ºè¿™ä¸ªæ–­è¨€æ˜¯æ­£ç¡®çš„ï¼Œliståˆ—è¡¨é•¿åº¦åˆšå¥½ä¸º2ï¼Œè¿™é‡Œä¸ºäº†éªŒè¯è¿”å›çš„listæ˜¯æ•´ä¸ªæ•°æ®åº“é•¿åº¦è¿˜æ˜¯ä»…ä»…è¡¨ç¤ºæ­¤æ¬¡è¿›è¡Œæ’å…¥æ“ä½œçš„é•¿åº¦ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸€ä¸‹ insert()æµ‹è¯•å•å…ƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line"> fun insert() &#123;</span><br><span class="line">     val book1 = Book(&quot;æ—¶é—´ç®€å²&quot;, &quot;æ–¯è’‚èŠ¬Â·å¨å»‰Â·éœé‡‘&quot;, &quot;ç§‘å­¦&quot;)</span><br><span class="line">     val book2 = Book(&quot;ç™¾å¹´å­¤ç‹¬&quot;, &quot;è¥¿äºšÂ·é©¬å°”å…‹æ–¯&quot;, &quot;æ–‡å­¦&quot;)</span><br><span class="line">     val list = bookDao!!.insert(book1, book2)</span><br><span class="line">     assert(list.size == 2)</span><br><span class="line"></span><br><span class="line">     val list2 = bookDao!!.insert(book1, book2)</span><br><span class="line">     assert(list2.size == 4)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™åœ¨ <strong>insert()å•å…ƒæµ‹è¯•åŒºåŸŸ</strong> å³é”®è¿è¡Œï¼Œå°±åªæµ‹è¯•è¿™ä¸€ä¸ªå•å…ƒï¼Œç„¶åç»“æœå¦‚ä¸‹ï¼š</p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/012.png" alt="image"></p>
<p>æˆ‘ä»¬åœ¨ insert()å•å…ƒ ä¸­è¿›è¡Œäº†ä¸¤æ¬¡æ’å…¥æ“ä½œï¼Œæ‰€ä»¥æ•°æ®åº“çš„æ€»é•¿åº¦åº”è¯¥ä¸º 4 ï¼Œè€Œè¿™é‡Œç¬¬39è¡Œçš„ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert(list2.size == 4)</span><br></pre></td></tr></table></figure>
<p>è¿”å›çš„cede æ˜¯ -1ï¼Œå°±è¡¨ç¤ºå®é™…ä¸Šæ¯æ¬¡æ’å…¥æ“ä½œè¿”å›çš„åˆ—è¡¨é•¿åº¦åº”è¯¥ä¸ºæ’å…¥çš„æ•°é‡ï¼Œè€Œéæ•°æ®åº“æ€»é‡ã€‚å…¶ä»–æ“ä½œäº¦æ˜¯å¦‚æ­¤ã€‚</p>
<p>åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬çš„æµ‹è¯•å¹¶ä¸èƒ½ç›´æ¥ç”¨äºæ­£å¼çš„é¡¹ç›®ä¸­ï¼Œå› ä¸ºæ•°æ®åº“æ“ä½œå±äºè€—æ—¶æ“ä½œï¼Œæ‰€ä»¥ä¸€å®šä¸èƒ½æŠŠè¿™äº›æ“ä½œæ”¾åœ¨ä¸»çº¿ç¨‹é‡Œï¼Œè€Œæœ€æ–¹ä¾¿çš„çº¿ç¨‹åˆ‡æ¢ï¼Œè«è¿‡äº <strong>Rxjava</strong> å•¦ï¼</p>
<p>ç°åœ¨å¼€å§‹ä½¿ç”¨ <strong>Rxjava</strong> è¿›è¡Œæµ‹è¯•å§</p>
<h3 id="ç»“åˆRxjavaçš„æµ‹è¯•"><a href="#ç»“åˆRxjavaçš„æµ‹è¯•" class="headerlink" title="ç»“åˆRxjavaçš„æµ‹è¯•"></a>ç»“åˆRxjavaçš„æµ‹è¯•</h3><p>é¦–å…ˆï¼Œè¦åœ¨é¡¹ç›®ä¸­æ·»åŠ  <strong>Rxjava</strong> çš„ä¾èµ–ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//rxJava2+rxAndroid</span><br><span class="line">implementation &quot;io.reactivex.rxjava2:rxjava:2.x.y&quot;</span><br><span class="line">implementation &apos;io.reactivex.rxjava2:rxandroid:2.1.0&apos;</span><br></pre></td></tr></table></figure>
<p>åœ¨å•å…ƒæµ‹è¯•ä¸­ï¼ŒRxJava å¦‚æœåš <strong>IOçº¿ç¨‹</strong> åˆ° <strong>UIçº¿ç¨‹</strong> çš„åˆ‡æ¢æ“ä½œï¼Œç»“æœæ˜¯æ— æ³•è·å–çš„ï¼Œæ‰€ä»¥éœ€è¦å°†è¿™äº›çº¿ç¨‹è¿›è¡Œåˆå¹¶ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">@Before</span><br><span class="line">@Throws(Exception::class)</span><br><span class="line">fun setUp() &#123;</span><br><span class="line">    val context = InstrumentationRegistry.getTargetContext()</span><br><span class="line">    bookDataBase = BookDataBase.getInstance(context)</span><br><span class="line">    bookDao = bookDataBase!!.bookDao()</span><br><span class="line">    ShadowLog.stream = System.out</span><br><span class="line"></span><br><span class="line">    initRxJava2()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private fun initRxJava2() &#123;</span><br><span class="line">    RxJavaPlugins.reset()</span><br><span class="line">    RxJavaPlugins.setIoSchedulerHandler &#123; Schedulers.trampoline() &#125;</span><br><span class="line">    RxAndroidPlugins.reset()</span><br><span class="line">    RxAndroidPlugins.setMainThreadSchedulerHandler &#123; Schedulers.trampoline() &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ <strong>@Beforeæ³¨è§£</strong> ä¸‹çš„ <strong>setUp()</strong> æ–¹æ³•ä¸­è¿›è¡ŒRxJavaçš„é…ç½®ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥æŠŠRxJavaå¸¸ç”¨çš„çº¿ç¨‹åˆ‡æ¢å†™åœ¨ä¸€ä¸ªæ–¹æ³•é‡Œï¼Œæ–¹ä¾¿å¤ç”¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">private fun&lt;T&gt; doWithRxJava(t: T): Observable&lt;T&gt;&#123;</span><br><span class="line">    return Observable.create&lt;T&gt;&#123;it.onNext(t)&#125;</span><br><span class="line">            .subscribeOn(Schedulers.io())</span><br><span class="line">            .unsubscribeOn(Schedulers.io())</span><br><span class="line">            .observeOn(AndroidSchedulers.mainThread())</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ¥ç€ï¼Œå¯¹ <strong>insertå•å…ƒ</strong> å’Œ <strong>queryå•å…ƒ</strong> è¿›è¡Œä¿®æ”¹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">fun insert() &#123;</span><br><span class="line">    val book1 = Book(&quot;æ—¶é—´ç®€å²&quot;, &quot;æ–¯è’‚èŠ¬Â·å¨å»‰Â·éœé‡‘&quot;, &quot;ç§‘å­¦&quot;)</span><br><span class="line">    val book2 = Book(&quot;ç™¾å¹´å­¤ç‹¬&quot;, &quot;è¥¿äºšÂ·é©¬å°”å…‹æ–¯&quot;, &quot;æ–‡å­¦&quot;)</span><br><span class="line">    doWithRxJava(bookDao!!.insert(book1, book2))</span><br><span class="line">            .subscribe (&#123;</span><br><span class="line">                Log.e(&quot;inserté•¿åº¦ï¼š&quot; , &quot;$&#123;it.size&#125;&quot;)</span><br><span class="line">                assert(it.size == 2)</span><br><span class="line">            &#125;,&#123;</span><br><span class="line">                Log.e(&quot;insertå‡ºé”™ï¼š&quot; , &quot;$&#123;it.stackTrace&#125;-$&#123;it.message&#125;&quot;)</span><br><span class="line">            &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@Test</span><br><span class="line">fun query()&#123;</span><br><span class="line">    doWithRxJava(bookDao?.all)</span><br><span class="line">            .subscribe(&#123;</span><br><span class="line">                for(book in it?: emptyList())&#123;</span><br><span class="line">                    Log.e(javaClass.name, &quot;è·å–çš„ä¹¦ç±æ•°æ®: $&#123;Gson().toJson(book)&#125;&quot;)</span><br><span class="line">                    assert(it?.size == 2)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,&#123;</span><br><span class="line">                Log.e(&quot;queryå‡ºé”™ï¼š&quot; , &quot;$&#123;it.stackTrace&#125;-$&#123;it.message&#125;&quot;)</span><br><span class="line">            &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åçœ‹ä¸€ä¸‹æµ‹è¯•çš„ç»“æœï¼š</p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/013.png" alt="image"></p>
<p>é‚£ä¹ˆï¼Œ <strong>Room DataBase</strong> çš„å…¥é—¨æŒ‡å—ï¼Œå°±å†™åˆ°è¿™é‡Œå•¦ï¼</p>
<p>åç»­æˆ‘å¯èƒ½ä¼šå†å†™ä¸€ç¯‡è¿›é˜¶ç‰ˆçš„æ–‡ç« ï¼Œæ¶µç›–äº†çœŸå®ä½¿ç”¨çš„åœºæ™¯ï¼Œç„¶åçœ‹èƒ½ä¸èƒ½å†™ä¸€ä¸ªç®€å•çš„Demoå‡ºæ¥ï¼Œè¿™æ ·æ›´æ–¹ä¾¿å­¦ä¹ å§ï¼</p>
<p><del><em>ä¸è¿‡æˆ‘å‘ç°æˆ‘ç°åœ¨çš„æ‡’ç™Œæ˜¯è¶Šæ¥è¶Šä¸¥é‡äº†ï¼Œä¹Ÿä¸çŸ¥é“ä¸‹ä¸€ç¯‡æ˜¯ä»€ä¹ˆæ—¶å€™</em></del></p>
<p><img src="https://blog-pic-1256696029.cos.ap-guangzhou.myqcloud.com/Room-Database/014.png" alt="image"></p>

      
    </div>

    

    
    
    


    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/10/20/DataBindingâ€”â€”ä»ç›¸è¯†åˆ°ç›¸çŸ¥ï¼ˆäºŒï¼‰ï¼šäº’é…Œ/" rel="next" title="DataBindingâ€”â€”ä»ç›¸è¯†åˆ°ç›¸çŸ¥ï¼ˆäºŒï¼‰ï¼šäº’é…Œ">
                <i class="fa fa-chevron-left"></i> DataBindingâ€”â€”ä»ç›¸è¯†åˆ°ç›¸çŸ¥ï¼ˆäºŒï¼‰ï¼šäº’é…Œ
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/02/Android-Studioè‡ªå®šä¹‰æ¨¡æ¿å®ç°ä¸€é”®åˆ›å»ºMVPç»“æ„/" rel="prev" title="Android Studioè‡ªå®šä¹‰æ¨¡æ¿å®ç°ä¸€é”®åˆ›å»ºMVPç»“æ„">
                Android Studioè‡ªå®šä¹‰æ¨¡æ¿å®ç°ä¸€é”®åˆ›å»ºMVPç»“æ„ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1532883475752&di=918e8ad03b17db01c84cdca20dd0ecdb&imgtype=0&src=http%3A%2F%2Fimg5.duitang.com%2Fuploads%2Fitem%2F201204%2F28%2F20120428125420_iUrGK.thumb.700_0.jpeg"
                alt="Old Chen" />
            
              <p class="site-author-name" itemprop="name">Old Chen</p>
              <p class="site-description motion-element" itemprop="description">çŸ¥æƒ‘é¡¿æ–­å¦‚ç¢çŸ³ï¼Œæ€æƒ‘éš¾æ–­å¦‚è—•ä¸</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">æ—¥å¿—</span>
                  </a>
                </div>
              

              

              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  <a href="https://github.com/asjqkkkk" target="_blank" title="GitHub"><i class="fa fa-fw fa-github"></i>GitHub</a>
                  
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://blog.csdn.net/asjqkkkk" target="_blank" title="csdn"><i class="fa fa-fw fa-rss-square"></i>csdn</a>
                  
                </span>
              
            </div>
          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#ä¸€ã€ä»‹ç»ä¸æ¯”è¾ƒ"><span class="nav-number">1.</span> <span class="nav-text">ä¸€ã€ä»‹ç»ä¸æ¯”è¾ƒ</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ä»‹ç»"><span class="nav-number">1.1.</span> <span class="nav-text">ä»‹ç»</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#GreenDao-å’Œ-ObjectBox"><span class="nav-number">1.1.1.</span> <span class="nav-text">GreenDao å’Œ ObjectBox</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Realm"><span class="nav-number">1.1.2.</span> <span class="nav-text">Realm</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Room"><span class="nav-number">1.1.3.</span> <span class="nav-text">Room</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¯”è¾ƒ"><span class="nav-number">1.2.</span> <span class="nav-text">æ¯”è¾ƒ</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#äºŒã€Roomçš„ç»“æ„"><span class="nav-number">2.</span> <span class="nav-text">äºŒã€Roomçš„ç»“æ„</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Database-æ•°æ®åº“"><span class="nav-number">2.1.</span> <span class="nav-text">Database(æ•°æ®åº“)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Entity-å®ä½“"><span class="nav-number">2.2.</span> <span class="nav-text">Entity(å®ä½“)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DAO"><span class="nav-number">2.3.</span> <span class="nav-text">DAO</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ä¸‰ã€å¼€å§‹ä½¿ç”¨"><span class="nav-number">3.</span> <span class="nav-text">ä¸‰ã€å¼€å§‹ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#æ¥å…¥Gradle"><span class="nav-number">3.1.</span> <span class="nav-text">æ¥å…¥Gradle</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åˆ›å»º-Entityã€Dao-ä¸-DataBase"><span class="nav-number">3.2.</span> <span class="nav-text">åˆ›å»º Entityã€Dao ä¸ DataBase</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ›å»ºEntity"><span class="nav-number">3.2.1.</span> <span class="nav-text">åˆ›å»ºEntity</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ›å»º-DAO"><span class="nav-number">3.2.2.</span> <span class="nav-text">åˆ›å»º DAO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆ›å»º-DataBase"><span class="nav-number">3.2.3.</span> <span class="nav-text">åˆ›å»º DataBase</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æµ‹è¯•"><span class="nav-number">3.3.</span> <span class="nav-text">æµ‹è¯•</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#åˆçº§æµ‹è¯•"><span class="nav-number">3.3.1.</span> <span class="nav-text">åˆçº§æµ‹è¯•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ç»“åˆRxjavaçš„æµ‹è¯•"><span class="nav-number">3.3.2.</span> <span class="nav-text">ç»“åˆRxjavaçš„æµ‹è¯•</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">oldchen</span>

  

  
</div>




   <div class="powered-by">ç”± <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨ v3.7.1</div> 



  <span class="post-meta-divider">|</span>



  <div class="theme-info">ä¸»é¢˜ &mdash; <a class="theme-link" target="_blank" href="https://theme-next.org">NexT.Mist</a> v6.3.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  













  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.3.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.3.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.3.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.3.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.3.0"></script>



  



  










  





  

  

  

  

  
  

  

  

  

  

  

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"position":"right","width":75,"height":150},"mobile":{"show":true},"log":false});</script></body>
</html>
